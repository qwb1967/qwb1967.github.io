webpackJsonp([9],{DuOb:function(e,t){},YvJ1:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("vQ9I"),r={data:function(){return{topUpAmount:"",payChannel:1,expectEndDate:"",containFood:0,remark:"",cage:"",PayChannel:[],searchValue:"",select:"",fosterCares:{},fosterCareId:0,tableData:[],dialogTitle:"",dialogFormVisible:!1,category:[],searchType:[{key:"",value:"全部"}],cellWidth:"",form:{ownerId:0,name:"",petId:0,petName:"",beginDate:"",unitPrice:""},formLabelWidth:"240px",info:0,pageNum:1,pageSize:10,serType:0,restaurants:[],searchDate:"",pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},fcrules:{name:[{required:!0,message:"请选择会员",trigger:"blur"}],petName:[{required:!0,message:"请选择宠物",trigger:"blur"}],unitPrice:[{required:!0,message:"请输入单价",trigger:"blur"}],beginDate:[{required:!0,message:"请输入开始时间",trigger:"blur"}]}}},mounted:function(){this.getFosterCares(),this.getPayChannel()},methods:{getFosterCares:function(){var e=this;Object(s.a)({url:"/api/fosterCare/list",method:"get",params:{pageNum:this.pageNum,pageSize:this.pageSize,name:this.searchValue,type:this.select,startDate:null!==this.searchDate?this.searchDate[0]:"",endDate:null!==this.searchDate?this.searchDate[1]:""},success:function(t){e.fosterCares=t.data.data,e.tableData=t.data.data.list},fail:function(e){console.log(e)}},this)},querySearchAsync:function(e,t){Object(s.a)({url:"/api/owner/getUserOwnerDtoList",method:"get",params:{str:e},success:function(e){var a=e.data.data;t(a)},fail:function(e){console.log(e)}},this)},handleSelect:function(e){var t=this;Object(s.a)({url:"/api/owner/getUserOwnerHomePageInfo",method:"get",params:{id:e.id},success:function(a){200===a.data.code?(t.form=a.data.data,t.form.ownerId=e.id):t.$message({message:"查询会员信息失败",center:!0,type:"error"})},fail:function(e){console.log(e)}},this)},petSelect:function(e){this.form.petId=this.form.petHomePageInfos[e].id,this.form.petName=this.form.petHomePageInfos[e].name,this.form.breed=this.form.petHomePageInfos[e].breed,this.form.coatColor=this.form.petHomePageInfos[e].coatColor,this.form.weight=this.form.petHomePageInfos[e].weight,this.form.petSex=this.form.petHomePageInfos[e].sex},clearInputValue:function(){this.form={name:"",petName:"",beginDate:"",unitPrice:""},this.topUpAmount="",this.payChannel=1,this.expectEndDate="",this.containFood=0,this.cage="",this.remark="",this.fosterCareId=0},fosterCareEdit:function(e){var t=this;this.clearInputValue(),this.$nextTick(function(){t.$refs.form.resetFields()}),this.info=1,this.dialogTitle="编辑寄养信息",Object(s.a)({url:"/api/fosterCare/info",method:"get",params:{id:e},success:function(a){200===a.data.code?(t.fosterCareId=e,t.form=a.data.data,t.form.ownerId=a.data.data.ownerId,t.form.petId=a.data.data.petId,t.form.petName=a.data.data.petName,t.form.unitPrice=a.data.data.unitPrice,t.topUpAmount=a.data.data.topUpAmount,t.payChannel=a.data.data.payChannel,t.form.beginDate=a.data.data.beginDate,t.expectEndDate=a.data.data.expectEndDate,t.containFood=a.data.data.containFood,t.cage=a.data.data.cage,t.remark=a.data.data.remark,t.dialogFormVisible=!0):t.$message({message:"编辑失败",center:!0,type:"error"})},fail:function(e){console.log(e)}},this)},saveFosterCareInfo:function(){var e=this;this.$refs.form.validate(function(t){t&&(1===e.info?Object(s.a)({url:"/api/fosterCare/edit",method:"post",data:{id:e.fosterCareId,ownerId:e.form.ownerId,petId:e.form.petId,unitPrice:e.form.unitPrice,topUpAmount:e.topUpAmount,payChannel:e.payChannel,beginDate:e.form.beginDate,expectEndDate:e.expectEndDate,containFood:e.containFood,cage:e.cage,remark:e.remark},success:function(t){200===t.data.code?(e.$message({message:"编辑成功",center:!0,type:"success"}),e.clearInputValue(),e.dialogFormVisible=!1,e.getFosterCares()):e.$message({message:"编辑失败",center:!0,type:"error"})},fail:function(e){console.log(e)}},e):Object(s.a)({url:"/api/fosterCare/save",method:"post",data:{ownerId:e.form.ownerId,petId:e.form.petId,unitPrice:e.form.unitPrice,topUpAmount:e.topUpAmount,payChannel:e.payChannel,beginDate:e.form.beginDate,expectEndDate:e.expectEndDate,containFood:e.containFood,cage:e.cage,remark:e.remark},success:function(t){200===t.data.code?(e.$message({message:"新增成功",center:!0,type:"success"}),e.form={},e.dialogFormVisible=!1,e.getFosterCares()):e.$message({message:"新增失败",center:!0,type:"error"})},fail:function(e){console.log(e)}},e))})},fosterCareAdd:function(){var e=this;this.clearInputValue(),this.info=2,this.dialogTitle="新增寄养",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.form.resetFields()})},handleCurrentChange:function(e){this.pageNum=e,this.getFosterCares()},getPayChannel:function(){var e=this;Object(s.a)({url:"/api/payChannel/list",method:"get",success:function(t){e.PayChannel=t.data.data},fail:function(e){console.log(e)}},this)},fosterCareDelete:function(e){var t=this;this.$confirm("此操作将撤销该寄养记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){Object(s.a)({url:"/api/fosterCare/del",method:"get",params:{id:e},success:function(e){t.$message({message:"已撤销",center:!0,type:"success"}),t.getFosterCares()},fail:function(e){console.log(e)}},t)}).catch(function(){t.$message({type:"info",center:!0,message:"已取消"})})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("div",{staticClass:"search"},[a("div",{staticClass:"frame"},[a("el-date-picker",{staticClass:"pickerStyle",attrs:{size:"medium",type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions2},model:{value:e.searchDate,callback:function(t){e.searchDate=t},expression:"searchDate"}})],1),e._v(" "),a("div",{staticClass:"frame"},[a("el-input",{attrs:{size:"medium",placeholder:"宠物名称、手机号、会员名称",clearable:""},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),a("div",{staticClass:"frame-btn"},[a("el-button",{attrs:{size:"medium",type:"primary",icon:"el-icon-search",round:""},on:{click:e.getFosterCares}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"medium",type:"danger",round:"",icon:"el-icon-plus"},on:{click:e.fosterCareAdd}},[e._v("新增")])],1)]),e._v(" "),a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"姓名",align:"center",width:e.cellWidth},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.vipName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"电话",align:"center",width:e.cellWidth},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.phone)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"宠物",align:"center",width:e.cellWidth},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.petName)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"寄养单价",align:"center",width:e.cellWidth},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.unitPrice)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"预存金额",align:"center",width:e.cellWidth},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.topUpAmount)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"起始时间（寄养天数）",align:"center",width:e.cellWidth},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.beginDate)+"（"),a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.days))]),e._v("）\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:e.cellWidth},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?a("el-button",{attrs:{icon:"el-icon-edit",size:"small",round:""},on:{click:function(a){return e.fosterCareEdit(t.row.id)}}},[e._v("编辑")]):e._e(),e._v(" "),1===t.row.status?a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small",round:""},on:{click:function(a){return e.fosterCareDelete(t.row.id)}}},[e._v("撤销")]):e._e(),e._v(" "),2===t.row.status?a("span",[e._v("已结账")]):e._e()]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,width:"1200px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.fcrules}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"选择会员：",prop:"name"}},[a("span",{staticClass:"right_input"},[a("el-autocomplete",{staticStyle:{width:"240px"},attrs:{size:"medium","fetch-suggestions":e.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1,disabled:1===e.info},on:{select:e.handleSelect},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"选择宠物：",prop:"petName"}},[a("el-select",{staticStyle:{width:"240px"},attrs:{size:"medium",disabled:1===e.info,filterable:"",placeholder:"请选择"},on:{change:e.petSelect},model:{value:e.form.petName,callback:function(t){e.$set(e.form,"petName",t)},expression:"form.petName"}},e._l(e.form.petHomePageInfos,function(e,t){return a("el-option",{key:e.id,attrs:{label:e.name,value:t}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"寄养单价：",prop:"unitPrice"}},[a("span",{staticClass:"right_input"},[a("el-input",{attrs:{size:"medium","auto-complete":"off"},model:{value:e.form.unitPrice,callback:function(t){e.$set(e.form,"unitPrice",t)},expression:"form.unitPrice"}})],1)])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"手机号码："}},[a("span",{staticClass:"right_input"},[e._v(e._s(e.form.phone))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"宠物品种："}},[a("span",{staticClass:"right_input"},[e._v(e._s(e.form.breed))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"预存金额："}},[a("span",{staticClass:"right_input"},[a("el-input",{attrs:{size:"medium","auto-complete":"off"},model:{value:e.topUpAmount,callback:function(t){e.topUpAmount=t},expression:"topUpAmount"}})],1)])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"会员卡号："}},[a("span",{staticClass:"right_input"},[e._v(e._s(e.form.number))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"宠物毛色："}},[a("span",{staticClass:"right_input"},[e._v(e._s(e.form.coatColor))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"支付方式："}},[a("span",{staticClass:"right_input"},[a("el-select",{staticStyle:{width:"240px"},attrs:{slot:"prepend",size:"medium",placeholder:"请选择"},slot:"prepend",model:{value:e.payChannel,callback:function(t){e.payChannel=t},expression:"payChannel"}},e._l(e.PayChannel,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"会员卡级别："}},[a("span",{staticClass:"right_input"},[e._v(e._s(e.form.vipName))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"宠物体重："}},[a("span",{staticClass:"right_input"},[e._v(e._s(e.form.weight))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"房间编号："}},[a("span",{staticClass:"right_input"},[a("el-input",{attrs:{size:"medium","auto-complete":"off"},model:{value:e.cage,callback:function(t){e.cage=t},expression:"cage"}})],1)])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"会员卡余额："}},[a("span",{staticClass:"right_input"},[e._v(e._s(e.form.residueAmount))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"宠物性别："}},[a("span",{staticClass:"right_input"},[e._v(e._s(1==e.form.petSex?"公":2==e.form.petSex?"母":""))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"开始时间：",prop:"beginDate"}},[a("span",{staticClass:"right_input"},[a("el-date-picker",{staticStyle:{width:"240px"},attrs:{size:"medium","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.beginDate,callback:function(t){e.$set(e.form,"beginDate",t)},expression:"form.beginDate"}})],1)])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"折扣比例："}},[a("span",{staticClass:"right_input"},[e._v(e._s(e.form.entrustDiscountRatio)),null!=e.form.entrustDiscountRatio?a("span",[e._v("%")]):e._e()])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"包含宠粮："}},[a("span",{staticClass:"right_input"},[a("el-switch",{attrs:{size:"medium","active-value":1,"inactive-value":0},model:{value:e.containFood,callback:function(t){e.containFood=t},expression:"containFood"}})],1)])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"结束时间："}},[a("span",{staticClass:"right_input"},[a("el-date-picker",{staticStyle:{width:"240px"},attrs:{size:"medium","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.expectEndDate,callback:function(t){e.expectEndDate=t},expression:"expectEndDate"}})],1)])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注："}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium",round:""},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"medium",type:"primary",round:""},on:{click:e.saveFosterCareInfo}},[e._v("确 定")])],1)],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"page-size":10,background:"",layout:"total, prev, pager, next",total:e.fosterCares.total},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var n=a("C7Lr")(r,o,!1,function(e){a("DuOb")},"data-v-88ad6762",null);t.default=n.exports}});